// RUN: hlo-opt %s --platform=gpu --stage=llvm-before-optimizations --xla_gpu_target_config_filename=%S/../../../tools/hlo_opt/gpu_specs/%{GPU}.txtpb | FileCheck --check-prefixes=CHECK-%{PTX} %s

// NOTE: Assertions have been autogenerated by utils/generate-test-checks.py

// The script is designed to make adding checks to
// a test case fast, it is *not* designed to be authoritative
// about what constitutes a good test! The CHECK should be
// minimized and named to reflect the test intent.


// CHECK-PTX:         call void @llvm.nvvm.barrier0
// CHECK-GCN:         call void @llvm.amdgcn.s.barrier

HloModule Test, is_scheduled=true


fused_computation {
  param_0 = f32[100,200]{1,0} parameter(0)
  ROOT b.1 = f32[100,200]{0,1} copy(f32[100,200]{1,0} param_0)
}

ENTRY main {
  a = f32[100, 200]{1,0} parameter(0)
  ROOT wrapped_b = f32[100,200]{0,1} fusion(f32[100,200]{1,0} a), kind=kInput, calls=fused_computation
}
